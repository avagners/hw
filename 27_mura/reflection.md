# Формализуем многослойную (многоуровневую) архитектуру (МУРА)

## Apache Airflow

### Компоненты Apache Airflow:
- База данных метаданных (Metadata Database):  
**Роль:** Хранит информацию о DAG'ах, задачах, расписаниях и состоянии системы.  
**Независимость:** Может функционировать отдельно, обеспечивая хранение данных для других компонентов.

- Планировщик (Scheduler):  
**Роль:** Определяет, какие задачи должны быть выполнены, и распределяет их для исполнения.  
**Независимость:** Зависит от базы данных метаданных для получения информации о DAG'ах и задачах.

- Веб-сервер (Webserver):  
**Роль:** Предоставляет веб-интерфейс для мониторинга и управления рабочими процессами.  
**Независимость:** Зависит от базы данных метаданных для отображения информации; не участвует в исполнении задач.


- Исполнитель (Executor) и Рабочие узлы (Workers):  
**Роль:** Выполняют задачи, определённые в DAG'ах.  
**Независимость:** Получают задания от планировщика и могут быть настроены для распределённого исполнения задач.


### Соответствие МУРА:
Архитектура `Apache Airflow` соответствует принципам многослойной архитектуры:

- Чёткое разделение обязанностей: Каждый компонент выполняет специфическую функцию, что обеспечивает модульность системы.

- Иерархия зависимостей: Компоненты взаимодействуют друг с другом в определённом порядке, минимизируя циклические зависимости.

- Масштабируемость: Компоненты, такие как исполнители и рабочие узлы, могут быть масштабированы независимо для повышения производительности.

### Уровни в архитектуре Airflow:

- Уровень данных:  
База данных метаданных.  
**Роль:** Хранение и предоставление данных о состоянии системы.

- Уровень управления:  
Планировщик и веб-сервер.  
**Роль:** Планирование задач и предоставление интерфейса для управления.

- Уровень исполнения:  
Исполнитель и рабочие узлы.  
**Роль:** Непосредственное выполнение задач.


Таким образом, `Apache Airflow` имеет трёхуровневую архитектуру, где каждый уровень может быть развёрнут и масштабирован независимо, что соответствует принципам МУРА.

### МУРА -- строгая?

Если рассматривать веб-сервер и планировщик как части одного уровня управления, то это не нарушает строгой МУРА, так как взаимодействие происходит внутри одного слоя. В этом случае архитектура `Apache Airflow` действительно может быть определена как строгая МУРА, поскольку:

- Все уровни взаимодействуют только с нижележащими слоями или своим уровнем.  
`Webserver` и `Scheduler`, находясь в одном уровне, корректно взаимодействуют друг с другом.
Все компоненты верхнего уровня зависят только от сущностей, предоставленных нижележащими уровнями.
- Нет циклических зависимостей.

Ниже представлен граф (диаграмма) архитектуры `Apache Airflow`:
![airflow_architecture](/27_mura/airflow_architecture.png)
