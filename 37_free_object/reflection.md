# Идеи свободного объекта в проектах

## Логирование событий в VPN-сервисе

В VPN-сервисе можно внедрить структурированный журнал всех событий: подключения, смены серверов, перебора протоколов.
- Это позволит откатываться к состоянию до ошибки, анализировать, какие изменения привели к нестабильности соединения, и даже тестировать ретроактивные обновления без потерь данных.
- Например, если обновление изменило механику выбора серверов, можно смоделировать, как вел бы себя старый алгоритм при тех же входных данных.

## PostgreSQL (журнал транзакций WAL)

В PostgreSQL используется Write-Ahead Logging (WAL) — механизм, который записывает все изменения данных перед их применением.  
Признаки свободного объекта:
- Можно откатить транзакцию (ROLLBACK), даже если система внезапно упала.
- Можно реплицировать данные на другую БД, проигрывая события в том же порядке.
- Можно делать point-in-time recovery (PITR), восстанавливая состояние БД на любой момент в прошлом.

## Историзация данных в DWH (SCD Type 2)

В хранилищах данных часто используется медленно изменяющиеся измерения (Slowly Changing Dimensions, SCD Type 2), когда при обновлении записи старая версия сохраняется с временной меткой.  
Признаки свободного объекта:
- Можно восстановить состояние данных на любой момент времени.
- Можно проигрывать историю изменений и анализировать, как менялась сущность.
- Можно проводить аудит данных без потерь информации.

Пример:  
В системе учёта клиентов при смене адреса старая версия сохраняется, и аналитики могут проследить все переезды клиента.

## Выводы

Раньше я думал, что логи нужны только для отладки. Теперь я вижу, что структурированные логи — это настоящая машина времени для системы.

Теперь я понимаю, почему Git, Kafka, базы данных строятся вокруг идей свободного объекта. Возможность отката системы в прошлое не просто удобна, а делает код более гибким.

Оказывается, если хранить не только данные, но и всю историю их изменений, можно не бояться, что что-то сломается при новых требованиях. Теперь я понимаю, почему в крупных проектах важно не просто обновлять данные, а журналировать их эволюцию.

Если что-то вычислено на основе данных, но не сохранилась исходная информация — всё, ты теряешь возможность отката. Например, если в аналитике логируется только “количество пользователей онлайн”, а не конкретные сессии, потом нельзя узнать, кто именно был онлайн. Лучше хранить детализированные логи, даже если кажется порой избыточным.
