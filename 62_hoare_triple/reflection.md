# Триплы Хоара

## 1. Изменить этот код, чтобы постусловие оставалось истинным

### 1.1. Изменение операции

```
{ true }
a = 10;
b = 42;
{ a > 1, b > 1 }
c = Math.abs(a - b); // 10 - 42 = -32 → abs(-32) = 32
{ c > 1 }
```

### 1.2 Усиление инварианта

```
{ true }
a = 10;
{ a > 5 }  // Усилили постусловие для a
b = 42;
{ a > 5, b > 5 } // Усилили постусловие для b
c = a + b;
{ c > 1 }  // Следует из a > 5 и b > 5 → c > 10
```

Усилили промежуточные инварианты, чтобы они автоматически гарантировали конечное условие

### 1.3 Добавление проверки перед вычислением и гарантирование условия

```
{ true }
a = 10;
{ a > 1 }
b = 42;
{ a > 1, b > 1 }
if a <= 0:  // Защитная проверка
    a = 2   // Явно обеспечиваем постусловие
if b <= 0:  // Защитная проверка
    b = 2   // Явно обеспечиваем постусловие
c = a + b;
{ c > 1 }
```

Явно проверяем условие и обеспечиваем его выполнение.

### 1.4 Усиление постусловия через модификацию команды

```
{ true }
a = 10;
{ a > 1 }
b = 42;
{ a > 1, b > 1 }
c = max(2, a + b);  // Гарантированно c >= 2, независимо от входов
{ c > 1 }
```

## 2. Заполнить пустые места правильными условиями

```
{ a = 0 }  // Шаг 3 (a = 2 - 2)
b = 2 - a;
{ b = 2 }  // Шаг 2 (b = 4 / 2)
c = b * 2;
{ c = 4 }  // Шаг 1 (с = 5 - 1)
d = c + 1; 
{ d = 5 }
```

Чтобы найти предусловия для цепочки команд нужно начать с последнего постусловия и двигаться назад.
Таким образом находим слабейшее предусловие, которое гарантирует соблюдение постусловия.

## Выводы 

Данное упражнение напоминает о том, что важно думать в первую очередь не о коде, а "какие инварианты должны выполняться и как их гарантировать при любых изменениях".

Часто можно ослабить промежуточные условия или усилить их для упрощения логики. 
Для критических инвариантов стоит предусматривать проверки.